# Deployment using a node process manager (PM2)

## About the the node process manager (PM2)
[The Process Manager 2 (PM2) runtime edition](https://pm2.io/runtime/) is a tool for controlling processes on a system. It can be used to manage Node.js, Python and other applications.
From our perspective, the most important function is keeping your Volto application process alive. If your application crashes, PM2 will auto-restart it.
You can learn more in [the PM2 documentation](http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/)

## Setup and management of PM2
### Step 0 - Prepare a PM2 configuration script
The example shown below includes a relative path to the script, you will have to execute it from within your Volto application directory.
The `server.config.js` file below shows a simple PM2 configuration script.

```js
module.exports = {
  apps: [
    {
      script: './build/server.js',
      name: 'volto',
      cwd: './',
    },
  ],
};
```

!!! note Where does build/server.js come from?
    In a previous step you will have run ``yarn build`.
    One of the outputs of running `yarn build` is the creation of 
    the `build/server.js` file. The `server.config.js` file tells PM2 to
    launch and manage `build/server.js`.
    


### Step 1 - Install PM2

    npm install -g pm2


### Step 2 - start Volto with PM2

    pm2 start server.config.js

!!! tip things to do with PM2
    Inspect your Volto process

        pm2 show volto

    Stop Volto

        pm2 stop volto


    Restart Volto

       pm2 restart volto


## Configure NGINX to work with your Volto process
By default Volto listens on port 3000.
The following NGINX configuration will serve your volto app.

```nginx
upstream volto {
    server 127.0.0.1:3000;
}
server {

# ...

location ~ / {
  # Set to 1m during development
  location ~* \.(ico|jpg|jpeg|png|gif|svg|js|jsx|css|less|swf|eot|ttf|otf|woff|woff2)$ {
  add_header Cache-Control "public";
  expires +1m;
  proxy_pass http://volto;
}

# ...

}

```
